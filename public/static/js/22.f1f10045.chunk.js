(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[22],{666:function(e,t,n){"use strict";n(670)},669:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n(181);function a(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(s.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,c=function(){};return{s:c,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return r=e.done,e},e:function(e){o=!0,i=e},f:function(){try{r||null==n.return||n.return()}finally{if(o)throw i}}}}},688:function(e,t,n){"use strict";n.r(t);var s=n(129),a=n.n(s),c=n(669),i=n(187),r=n(186),o=n(182),l=n(183),h=n(185),u=n(184),d=n(1),b=n(179),m=n(58),j=n(62),p=(n(666),n(405),n(128)),f=n(27),x=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(o.a)(this,n),(s=t.call(this,e)).onTextChange=function(e){var t=e.currentTarget;s.setState(Object(r.a)({},t.name,t.value))},s.onSwitchChange=function(e){var t=e.currentTarget;s.setState(Object(r.a)({},t.name,t.checked))},s.onImageChange=function(e){e.target.files[0]&&s.getImagePreview(e.target.files[0]).then((function(t){s.setState(Object(r.a)({},e.target.name,{file:e.target.files[0],preview:t}))}))},s.onAssetsChange=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,i,r,o,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],i=Object(c.a)(t.target.files),e.prev=2,i.s();case 4:if((r=i.n()).done){e.next=12;break}return o=r.value,e.next=8,s.getImagePreview(o);case 8:l=e.sent,n.push({file:o,preview:l});case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),i.e(e.t0);case 17:return e.prev=17,i.f(),e.finish(17);case 20:n.length>0&&s.setState({assets:n});case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})));return function(t){return e.apply(this,arguments)}}(),s.handleSubmit=function(e){e.preventDefault(),s.setState({isLoading:!0});var t=s.state,n=t.name,a=t.isPublished,c=t.icon,i=t.assets,r=t.script,o=s.props.location.state,l=(o.storyName,o.storyID),h=(o.seasonName,o.seasonID),u=o.episodeIndex,d=[],b=j.a.firestore().collection("stories_dev").doc(l).collection("seasons").doc(h).collection("episodes");b.add({name:n,isPublished:a,index:u+1,likes:0}).then((function(e){var t="".concat("_dev","/stories/").concat(l,"/seasons/").concat(h,"/episodes/").concat(e.id);c.file&&d.push(s.uploadFileAsPromise(t,c.file,"icon.png")),d.push(s.uploadFileAsPromise(t,new Blob([r],{type:"text/plain"}),"script.txt")),i.forEach((function(e){d.push(s.uploadFileAsPromise("".concat(t,"/Assets"),e.file))})),Promise.all(d).then((function(e){Object(p.d)(p.a.SUCCESS,"Episode added successfully!"),s.backToList()})).catch((function(t){b.doc(e.id).delete().then((function(){Object(p.d)(p.a.ERROR,t.toString()),s.setState({isLoading:!1})})).catch((function(e){Object(p.d)(p.a.ERROR,e.toString()),s.setState({isLoading:!1})}))}))})).catch((function(e){Object(p.d)(p.a.ERROR,"Something went wrong. Try again!"),s.setState({isLoading:!1})}))},s.getImagePreview=function(e){return new Promise((function(t,n){var s=new FileReader;s.readAsDataURL(e);s.onloadend=function(e){t(s.result)}.bind(this)}))},s.backToList=function(){
//# sourceMappingURL=22.f1f10045.chunk.js.map