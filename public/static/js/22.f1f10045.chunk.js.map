{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","views/base/AddEpisode.js"],"names":["_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","length","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","step","next","_e2","BasicForms","props","onTextChange","input","currentTarget","setState","name","onSwitchChange","checked","onImageChange","event","target","files","getImagePreview","then","preview","file","onAssetsChange","a","push","assets","handleSubmit","preventDefault","isLoading","state","isPublished","icon","script","location","storyID","storyName","seasonID","seasonName","episodeIndex","promises","db","firebase","firestore","collection","doc","add","index","likes","docRef","path","id","uploadFileAsPromise","Blob","type","forEach","asset","Promise","all","r","showNotification","NOTIFICATION","SUCCESS","backToList","catch","delete","ERROR","toString","error","image","resolve","reject","reader","FileReader","readAsDataURL","onloadend","result","bind","this","console","log","history","pathname","undefined","directory","filename","uploadTask","storage","ref","put","on","TaskEvent","STATE_CHANGED","code","serverResponse","snapshot","getDownloadURL","downloadURL","className","color","style","width","height","onSubmit","row","xs","md","placeholder","maxLength","onChange","required","size","shape","htmlFor","accept","variant","multiple","rows","minHeight","src","map","onClick","Component"],"mappings":"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","file":"static/js/22.f1f10045.chunk.js","sourcesContent":["import unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = o[Symbol.iterator]();\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import React, {Component} from 'react'\nimport {\n    CButton,\n    CCard,\n    CCardBody,\n    CCardHeader,\n    CCol,\n    CForm,\n    CFormGroup, CImg,\n    CInput,\n    CInputFile,\n    CLabel,\n    CRow,\n    CSpinner,\n    CTextarea,\n    CSwitch\n} from '@coreui/react'\nimport CIcon from '@coreui/icons-react'\nimport firebase from 'firebase/app'\nimport 'firebase/storage'\nimport 'firebase/firestore'\nimport {NOTIFICATION, showNotification} from \"../../reusable/Utility\";\n\nconst directory = '_dev';\nconst switchConfig = { size: 'sm', variant: '3d', shape: 'pill' };\n\nclass BasicForms extends Component {\n    constructor(props) {\n        super(props);\n\n        if (props.location.state === undefined) {\n            this.backToList();\n        } else {\n            this.state = {\n                isLoading: false,\n                name: '',\n                isPublished: true,\n                script: '',\n                icon: {\n                    file: null,\n                    preview: null\n                },\n                assets: []\n            };\n        }\n    }\n\n    onTextChange = ({currentTarget: input}) => {\n        this.setState({[input.name]: input.value});\n    };\n\n    onSwitchChange = ({currentTarget: input}) => {\n        this.setState({[input.name]: input.checked});\n    };\n\n    onImageChange = event => {\n        if (event.target.files[0]) {\n            this.getImagePreview(event.target.files[0]).then(preview => {\n                this.setState({[event.target.name]: {file: event.target.files[0], preview: preview}});\n            });\n        }\n    };\n\n    onAssetsChange = async event => {\n        let files = [];\n        for (const file of event.target.files) {\n            let preview = await this.getImagePreview(file);\n            files.push({\n                file: file,\n                preview: preview\n            });\n        }\n        if (files.length > 0) this.setState({assets: files});\n    };\n\n    handleSubmit = e => {\n        e.preventDefault();\n        this.setState({isLoading: true});\n\n        const {name, isPublished, icon, assets, script} = this.state;\n        const {storyName, storyID, seasonName, seasonID, episodeIndex} = this.props.location.state;\n        let promises = [];\n\n        const db = firebase.firestore()\n            .collection('stories_dev')\n            .doc(storyID)\n            .collection('seasons')\n            .doc(seasonID)\n            .collection('episodes');\n\n        // Add a new document with a generated id.\n        db.add({\n            name: name,\n            isPublished: isPublished,\n            index: episodeIndex + 1,\n            likes: 0\n        }).then((docRef) => {\n            const path = `${directory}/stories/${storyID}/seasons/${seasonID}/episodes/${docRef.id}`;\n\n            if (icon.file) promises.push(this.uploadFileAsPromise(path, icon.file, 'icon.png'));\n            promises.push(this.uploadFileAsPromise(\n                path,\n                new Blob([script], {type: 'text/plain'}),\n                'script.txt'\n            ));\n            assets.forEach(asset => {\n                promises.push(this.uploadFileAsPromise(`${path}/Assets`, asset.file));\n            });\n\n            Promise.all(promises).then(r => {\n                showNotification(NOTIFICATION.SUCCESS, 'Episode added successfully!');\n                this.backToList();\n            }).catch(e => {\n                db.doc(docRef.id).delete().then(() => {\n                    // showNotification(NOTIFICATION.ERROR, 'Something went wrong. Try again!');\n                    showNotification(NOTIFICATION.ERROR, e.toString());\n                    this.setState({isLoading: false});\n                }).catch((error) => {\n                    showNotification(NOTIFICATION.ERROR, error.toString());\n                    this.setState({isLoading: false});\n                });\n            });\n        }).catch((error) => {\n            showNotification(NOTIFICATION.ERROR, 'Something went wrong. Try again!');\n            this.setState({isLoading: false});\n        });\n    };\n\n    getImagePreview = (image) => {\n        return new Promise(function (resolve, reject) {\n            let reader = new FileReader();\n            let url = reader.readAsDataURL(image);\n            reader.onloadend = function (e) {\n                resolve(reader.result);\n            }.bind(this);\n        });\n    };\n\n    //Handle waiting to upload each file using promise\n    uploadFileAsPromise(directory, file, filename = null) {\n        return new Promise(function (resolve, reject) {\n            filename = filename ? filename : file.name ;\n            const storageRef = firebase.storage().ref(directory + \"/\" + filename);\n            //Upload file\n            let uploadTask = storageRef.put(file);\n            // Listen for state changes, errors, and completion of the upload.\n            uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED,\n                null,\n                (error) => {\n                    // A full list of error codes is available at\n                    // https://firebase.google.com/docs/storage/web/handle-errors\n                    switch (error.code) {\n                        case 'storage/unauthorized':\n