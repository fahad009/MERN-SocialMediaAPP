(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[45],{666:function(e,s,t){"use strict";t(670)},684:function(e,s,t){"use strict";t.r(s);var n=t(72),i=t(77),a=t(182),o=t(183),c=t(185),d=t(184),l=t(1),r=t(62),j=t(128),h=(t(405),t(666),t(179)),u=t(58),p=t(732),b=t(27),m=(r.a.storage().ref(),r.a.firestore().collection("stories_dev")),x=["name","action"],O=["name"],f=function(e){Object(c.a)(t,e);var s=Object(d.a)(t);function t(e){var o;Object(a.a)(this,t),(o=s.call(this,e)).showSeasons=function(e){o.setState({isLoading:!0,storyID:e.id,storyName:e.name,episodes:null});var s=[],t=0;m.doc(e.id).collection("seasons").get().then((function(e){e.forEach((function(e){s.push({id:e.id,name:e.data().name,index:e.data().index}),t<e.data().index&&(t=e.data().index)})),o.setState({isLoading:!1,seasons:s,seasonIndex:t})}))},o.showEpisodes=function(e){o.setState({isLoading:!0,seasonID:e.id,seasonName:e.name});var s=o.state.storyID,t=[],n=0;m.doc(s).collection("seasons").doc(e.id).collection("episodes").get().then((function(e){e.forEach((function(e){t.push({id:e.id,name:e.data().name,index:e.data().index}),n<e.data().index&&(n=e.data().index)})),o.setState({isLoading:!1,episodes:t,episodeIndex:n})}))},o.addNewBook=function(){Object(j.c)(o.state),o.props.history.push({pathname:"/add-story",state:o.state})},o.addNewSeason=function(){var e=o.state,s=e.storyID,t=e.seasonIndex;o.setState({isLoading:!0}),m.doc(s).collection("seasons").add({name:"Season ".concat(t+1),index:t+1}).then((function(e){var s=[{id:e.id,name:"Season ".concat(t+1),index:t+1}];o.setState({seasons:[].concat(Object(i.a)(o.state.seasons),s),seasonIndex:t+1,isLoading:!1}),Object(j.d)(j.a.SUCCESS,"Season added successfully!")})).catch((function(e){Object(j.d)(j.a.ERROR,"Something went wrong. Try again!"),o.setState({isLoading:!1})}))},o.addNewEpisodes=function(){var e=o.state,s=e.storyID,t=e.seasonID,n=e.episodeIndex;o.setState({isLoading:!0}),m.doc(s).collection("seasons").doc(t).collection("episodes").add({name:"Episode ".concat(n+1),isPublished:!1,index:n+1,likes:0}).then((function(e){var s=[{id:e.id,name:"Episode ".concat(n+1),index:n+1}];o.setState({episodes:[].concat(Object(i.a)(o.state.episodes),s),episodeIndex:n+1,isLoading:!1}),Object(j.d)(j.a.SUCCESS,"Episode added successfully!")})).catch((function(e){Object(j.d)(j.a.ERROR,"Something went wrong. Try again!"),o.setState({isLoading:!1})}))},o.editBook=function(e){Object(j.c)(o.state),o.props.history.push({pathname:"/edit-story",state:{id:e.id}})},o.editEpisode=function(e){Object(j.c)(o.state),o.props.history.push({pathname:"/edit-episode",state:Object(n.a)(Object(n.a)({},o.state),{},{episodeID:e.id})})},o.closeSeasons=function(){o.setState({seasons:null,episodes:null})},o.closeEpisodes=function(){o.setState({episodes:null})};var c=Object(j.b)();return null!==c?(o.state=c,Object(j.c)(null)):o.state={isLoading:!0,storyName:null,storyID:null,seasonName:null,seasonID:null,seasonIndex:1,episodeIndex:1,stories:[],seasons:null,episodes:null,episodeID:null},o}return Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,s=[];m.get().then((function(t){t.forEach((function(e){s.push({id:e.id,name:e.data().name})})),e.setState({isLoading:!1,stories:s})}))}},{key:"render",value:function(){var e=this,s=this.state,t=s.isLoading,n=s.stories,i=s.seasons,a=s.episodes;return Object(b.jsx)(l.Fragment,{children:Object(b.jsx)(b.Fragment,{children:t?Object(b.jsx)("div",{className:"text-center",children:Object(b.jsx)(h.Ab,{className:"mt-5",color:"primary",style:{width:"4rem",height:"4rem"}})}):Object(b.jsxs)(h.rb,{children:[Object(b.jsx)(h.u,{className:"p-0",children:Object(b.jsxs)(h.j,{className:"h-100",children:[Object(b.jsxs)(h.n,{className:"d-flex justify-content-between",children:[Object(b.jsx)("h2",{children:"Stories"}),Object(b.jsx)(h.f,{variant:"outline",onClick:this.addNewBook,color:"primary",children:Object(b.jsx)(u.a,{content:p.a.cilPlus,size:"lg"})})]}),Object(b.jsx)(h.k,{children:Object(b.jsx)(h.y,{items:n,fields:x,onRowClick:this.showSeasons,clickableRows:!0,tableFilter:!0,hover:!0,border:!0,pagination:!0,responsive:!0,sorter:!0,itemsPerPage:100,scopedSlots:{action:function(s,t){return Object(b.jsx)("td",{className:"py-2",children:Object(b.jsx)(h.f,{color:"primary",variant:"ghost",shape:"pill",size:"sm",onClick:function(){return e.editBook(s)},children:Object(b.jsx)(u.a,{name:"cilPencil",size:"sm"})})})}}})})]})}),i&&Object(b.jsx)(h.u,{className:"p-0",children:Object(b.jsxs)(h.j,{className:"h-100",children:[Object(b.jsxs)(h.n,{className:"d-flex justify-content-between",children:[Object(b.jsx)("h2",{children:"Seasons"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(h.f,{onClick:this.addNewSeason,variant:"outline",color:"primary",children:Object(b.jsx)(u.a,{content:p.a.cilPlus,size:"lg"})}),Object(b.jsx)(h.f,{className:"ml-1",onClick:this.closeSeasons,variant:"outline",color:"danger",children:Object(b.jsx)(u.a,{content:p.a.cilArrowRight,size:"lg"})})]})]}),Object(b.jsx)(h.k,{children:Object(b.jsx)(h.y,{items:i,fields:O,onRowClick:this.showEpisodes,clickableRows:!0,tableFilter:!0,hover:!0,border:!0,pagination:!0,responsive:!0,sorter:!0,itemsPerPage:100})})]})}),a&&Object(b.jsx)(h.u,{className:"p-0",children:Object(b.jsxs)(h.j,{className:"h-100",children:[Object(b.jsxs)(h.n,{className:"d-flex justify-content-between",children:[Object(b.jsx)("h2",{children:"Episodes"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(h.f,{onClick:this.addNewEpisodes,variant:"outline",color:"primary",children:Object(b.jsx)(u.a,{content:p.a.cilPlus,size:"lg"})}),Object(b.jsx)(h.f,{className:"ml-1",onClick:this.closeEpisodes,variant:"outline",color:"danger",children:Object(b.jsx)(u.a,{content:p.a.cilArrowRight,size:"lg"})})]})]}),Object(b.jsx)(h.k,{children:Object(b.jsx)(h.y,{items:a,fields:x,tableFilter:!0,hover:!0,border:!0,pagination:!0,responsive:!0,sorter:!0,itemsPerPage:100,scopedSlots:{action:function(s,t){return Object(b.jsx)("td",{className:"py-2",children:Object(b.jsx)(h.f,{color:"primary",variant:"ghost",shape:"pill",size:"sm",onClick:function(){return e.editEpisode(s)},children:Object(b.jsx)(u.a,{name:"cilPencil",size:"sm"})})})}}})})]})})]})})})}}]),t}(l.Component);s.default=f}}]);
//# sourceMappingURL=45.bf80cdcb.chunk.js.map